#!/bin/sh

$HOME/.profile

# Make sure we are up-to-date
xrdb -merge $HOME/.config/xresources/config
xrdb -merge $HOME/.config/xresources/colors/$(cat $HOME/.theme)

INFILES=$(tr '\n' ' ' <<-ENDINFILES
	$HOME/.config/herbstluftwm/config
	$HOME/.config/polybar/config
	$HOME/.config/dunst/dunstrc
	$HOME/.config/rofi/xresources
	$HOME/.config/sddm/Main.qml
ENDINFILES
)
for file in $INFILES; do
    preprocess $file &
done && wait

killall polybar
killall herbstclient
killall compton
killall dunst
killall notify_battery

$HOME/.config/herbstluftwm/config
xrdb -merge $HOME/.config/rofi/xresources
xrdb -merge $HOME/.urxvt/config

# session configuration
#feh --no-fehbg --bg-fill ~/Pictures/wallpaper/pier.jpg
root_background=$(xrdb -query | awk '/*color7:/{print $2}')
hsetroot -solid "$root_background" &
xsetroot -cursor_name left_ptr &

# keyboard (no longer needed -- created kernel udev rule)
# setkbcolor -solid $root_background
# setxkbmap -option caps:swapescape &
# xset r rate 500 50 &

# user processes
dunst &
compton -b &
polybar top &
$HOME/.config/herbstluftwm/notify_battery &
